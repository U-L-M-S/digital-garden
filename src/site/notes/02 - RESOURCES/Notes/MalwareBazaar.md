---
{"dg-publish":true,"permalink":"/02-resources/notes/malware-bazaar/","tags":["informatik/sicherheit/malware","threat-intelligence"],"noteIcon":"","updated":"2025-11-07T11:35:59.527+01:00"}
---

> Datenbank von [[02 - RESOURCES/Notes/Malware\|Malware]]-Samples

**MalwareBazaar** ist ein Service von [[02 - RESOURCES/Notes/abuse.ch\|abuse.ch]]. Er sammelt [[02 - RESOURCES/Notes/Malware\|Malware]]-Samples und stellt sie für Forschung bereit.

---

## Was macht MalwareBazaar?

- **Sammelt [[02 - RESOURCES/Notes/Malware\|Malware]]-Samples**: Von Forschern weltweit
- **Analysiert sie**: Automatische Analyse
- **Stellt Hashes bereit**: SHA256, MD5, SHA1
- **Kategorisiert**: Nach [[02 - RESOURCES/Notes/Malware\|Malware]]-Familie (Emotet, TrickBot, etc.)
- **API-Zugriff**: Automatisierung möglich

## Verwendung

### 1. Hash-Abgleich

**Frage:** Ist diese Datei [[02 - RESOURCES/Notes/Malware\|Malware]]?

```python
import requests

url = "https://mb-api.abuse.ch/api/v1/"
data = {
    "query": "get_info",
    "hash": "SHA256_HASH_HERE"
}
response = requests.post(url, data=data)

if response.json()["query_status"] == "ok":
    print("Malware gefunden!")
    print(f"Name: {response.json()['data'][0]['file_name']}")
    print(f"Type: {response.json()['data'][0]['file_type']}")
else:
    print("Keine Malware")
```

### 2. Sample-Download

**Für Forschung:**
- Download von [[02 - RESOURCES/Notes/Malware\|Malware]]-Samples
- Passwort-geschützte ZIP-Archive
- Nur für legitime Forschung

> [!warning] Vorsicht
> [[02 - RESOURCES/Notes/Malware\|Malware]]-Samples nur in isolierter Umgebung öffnen! Am besten in VM ohne Netzwerk.

### 3. Aktuelle Bedrohungen

**Frage:** Was ist gerade aktiv?

```python
url = "https://mb-api.abuse.ch/api/v1/"
data = {
    "query": "get_recent",
    "selector": 10  # Letzte 10 Samples
}
response = requests.post(url, data=data)
```

## Integration mit [[02 - RESOURCES/Notes/Suricata\|Suricata]]

MalwareBazaar-Signaturen können in [[02 - RESOURCES/Notes/Suricata\|Suricata]] genutzt werden:

```
Services → Intrusion Detection → Download
  - abuse.ch (enthält MalwareBazaar-Signaturen)
```

## API-Endpunkte

**Hauptfunktionen:**
- `get_info`: Info zu Hash
- `get_recent`: Letzte Samples
- `get_file`: Sample herunterladen
- `get_taginfo`: Samples nach Tag
- `get_cscb`: C2-Tracker

## Beispiel-Response

```json
{
  "query_status": "ok",
  "data": [
    {
      "sha256_hash": "abc123...",
      "file_name": "invoice.exe",
      "file_type": "exe",
      "file_size": 123456,
      "signature": "Emotet",
      "first_seen": "2025-01-07 10:00:00",
      "tags": ["exe", "Emotet"]
    }
  ]
}
```

## Malware-Familien

**Häufige Familien in MalwareBazaar:**
- **Emotet**: Banking-Trojaner
- **TrickBot**: Banking-Trojaner
- **Qakbot**: Banking-Trojaner
- **AgentTesla**: Keylogger
- **RedLine**: Infostealer
- **Cobalt Strike**: Pentesting-Tool (missbraucht)

## Web-Interface

Auch ohne API nutzbar: `https://bazaar.abuse.ch/`

**Features:**
- Suche nach Hash
- Browse nach Tag
- Statistiken
- Sample-Download

> [!tip] Kostenlos
> MalwareBazaar ist kostenlos für alle. Keine Registration notwendig (außer für Sample-Download).
